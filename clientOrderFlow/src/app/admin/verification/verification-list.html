<div class="flex-1 flex flex-col">
  <admin-header [title]="'Заявки на верификацию'"></admin-header>

  <main class="flex-1 overflow-x-hidden overflow-y-auto p-6">
    <!-- Filters -->
    <div class="bg-white p-4 rounded-lg shadow-sm mb-6">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
        <input
          type="text"
          [(ngModel)]="searchQuery"
          (input)="applyFilters()"
          placeholder="Поиск по названию или УНП..."
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-indigo-500">

        <select
          [(ngModel)]="selectedRole"
          (change)="applyFilters()"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-indigo-500 bg-white">
          <option value="">Все роли</option>
          <option value="Поставщик">Поставщик</option>
          <option value="Торговая сеть">Торговая сеть</option>
        </select>

        <select
          [(ngModel)]="selectedStatus"
          (change)="applyFilters()"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-indigo-500 bg-white">
          <option value="">Все статусы</option>
          <option value="Ожидает проверки">Ожидает проверки</option>
          <option value="Одобрена">Одобрена</option>
          <option value="Отклонена">Отклонена</option>
        </select>

        <button
          (click)="applyFilters()"
          class="w-full bg-indigo-600 text-white py-2 px-4 rounded-md hover:bg-indigo-700">
          Применить
        </button>
      </div>
    </div>

    <!-- Applications Table -->
    <div class="bg-white rounded-lg shadow-sm overflow-hidden">
      <!-- Сообщение о загрузке -->
      <div *ngIf="isLoading" class="p-8 text-center">
        <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"></div>
        <p class="mt-2 text-gray-600">Загрузка заявок...</p>
      </div>

      <!-- Сообщение об ошибке -->
      <div *ngIf="errorMessage" class="p-4 bg-red-50 border-l-4 border-red-500">
        <p class="text-red-700">{{ errorMessage }}</p>
      </div>

      <!-- Таблица -->
      <div *ngIf="!isLoading && !errorMessage" class="overflow-x-auto">
        <table class="w-full text-sm text-left text-gray-500">
          <thead class="text-xs text-gray-700 uppercase bg-gray-50">
            <tr>
              <th scope="col" class="px-6 py-3">Название компании</th>
              <th scope="col" class="px-6 py-3">УНП</th>
              <th scope="col" class="px-6 py-3">Дата заявки</th>
              <th scope="col" class="px-6 py-3">Статус</th>
              <th scope="col" class="px-6 py-3 text-right">Действие</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let request of filteredRequests" class="bg-white border-b hover:bg-gray-50">
              <td class="px-6 py-4 font-medium text-gray-900">{{ request.companyName }}</td>
              <td class="px-6 py-4">{{ request.taxId }}</td>
              <td class="px-6 py-4">{{ request.displayDate }}</td>
              <td class="px-6 py-4">
                <span [ngClass]="request.statusClass" class="text-xs font-semibold px-2 py-1 rounded-full">
                  {{ getStatusDisplayName(request.status) }}
                </span>
              </td>
              <td class="px-6 py-4 text-right">
                <a [routerLink]="['/admin/verification', request.id]" class="font-medium text-indigo-600 hover:underline">
                  {{ request.status === 'PENDING' ? 'Проверить' : 'Просмотреть' }}
                </a>
              </td>
            </tr>
            <tr *ngIf="filteredRequests.length === 0">
              <td colspan="5" class="px-6 py-8 text-center text-gray-500">
                Заявки не найдены
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Pagination -->
      <div class="flex items-center justify-between p-4 border-t">
        <span class="text-sm text-gray-700">Показано <span class="font-semibold">1</span>-<span class="font-semibold">{{ filteredRequests.length }}</span> из <span class="font-semibold">{{ filteredRequests.length }}</span> заявок</span>
        <div class="inline-flex rounded-md shadow-sm">
          <a href="#" class="px-4 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-l-md hover:bg-gray-50 cursor-not-allowed">Назад</a>
          <a href="#" class="px-4 py-2 text-sm font-medium text-indigo-600 bg-indigo-50 border-t border-b border-indigo-500 hover:bg-indigo-100 z-10">1</a>
          <a href="#" class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-r-md hover:bg-gray-50">Вперед</a>
        </div>
      </div>

      <div *ngIf="filteredRequests.length === 0" class="p-12 text-center">
        <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
        </svg>
        <h3 class="mt-4 text-lg font-medium text-gray-900">Заявки не найдены</h3>
        <p class="mt-2 text-sm text-gray-500">Попробуйте изменить параметры фильтрации</p>
      </div>
    </div>
  </main>
</div>
