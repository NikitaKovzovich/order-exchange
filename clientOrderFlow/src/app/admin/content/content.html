<div class="flex-1 flex flex-col">
  <admin-header [title]="'Управление контентом'"></admin-header>

  <main class="flex-1 overflow-x-hidden overflow-y-auto p-6">
    <!-- Tabs -->
    <div class="border-b border-gray-200 mb-6">
      <nav class="-mb-px flex space-x-8" aria-label="Tabs">
        <a
          (click)="setActiveTab('products')"
          [ngClass]="activeTab === 'products' ? 'border-indigo-500 text-indigo-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'"
          class="whitespace-nowrap pb-4 px-1 border-b-2 font-medium text-sm cursor-pointer">
          Товары
        </a>
        <a
          (click)="setActiveTab('categories')"
          [ngClass]="activeTab === 'categories' ? 'border-indigo-500 text-indigo-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'"
          class="whitespace-nowrap pb-4 px-1 border-b-2 font-medium text-sm cursor-pointer">
          Категории
        </a>
      </nav>
    </div>

    <!-- Products Tab -->
    <div *ngIf="activeTab === 'products'">
      <!-- Filters -->
      <div class="bg-white p-4 rounded-lg shadow-sm mb-6">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
          <input
            type="text"
            [(ngModel)]="searchQuery"
            (input)="applyFilters()"
            placeholder="Поиск по названию..."
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-indigo-500">
          <select
            [(ngModel)]="selectedCategory"
            (change)="applyFilters()"
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-indigo-500 bg-white">
            <option value="">Все категории</option>
            <option>Молочные продукты</option>
            <option>Прочее</option>
          </select>
          <select
            [(ngModel)]="selectedSupplier"
            (change)="applyFilters()"
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-indigo-500 bg-white">
            <option value="">Все поставщики</option>
            <option>Продукты Оптом</option>
            <option>Сомнительный Поставщик</option>
          </select>
          <button
            (click)="applyFilters()"
            class="w-full bg-indigo-600 text-white py-2 px-4 rounded-md hover:bg-indigo-700">
            Применить
          </button>
        </div>
      </div>

      <!-- Products Table -->
      <div class="bg-white rounded-lg shadow-sm overflow-hidden">
        <div class="overflow-x-auto">
          <table class="w-full text-sm text-left text-gray-500">
            <thead class="text-xs text-gray-700 uppercase bg-gray-50">
              <tr>
                <th scope="col" class="px-6 py-3">Товар</th>
                <th scope="col" class="px-6 py-3">Поставщик</th>
                <th scope="col" class="px-6 py-3">Категория</th>
                <th scope="col" class="px-6 py-3">Цена</th>
                <th scope="col" class="px-6 py-3">Статус</th>
                <th scope="col" class="px-6 py-3 text-right">Действия</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let product of filteredProducts" class="bg-white border-b hover:bg-gray-50">
                <td class="px-6 py-4 font-medium text-gray-900">{{ product.name }}</td>
                <td class="px-6 py-4">{{ product.supplier }}</td>
                <td class="px-6 py-4">{{ product.category }}</td>
                <td class="px-6 py-4">{{ product.price }}</td>
                <td class="px-6 py-4">
                  <span [ngClass]="product.statusClass" class="text-xs font-semibold px-2 py-1 rounded-full">
                    {{ product.status }}
                  </span>
                </td>
                <td class="px-6 py-4 text-right space-x-2">
                  <button
                    *ngIf="product.status === 'Активен'"
                    (click)="openHideModal(product)"
                    class="font-medium text-yellow-600 hover:underline">
                    Скрыть
                  </button>
                  <button
                    *ngIf="product.status === 'Скрыт'"
                    (click)="showProduct(product)"
                    class="font-medium text-green-600 hover:underline">
                    Показать
                  </button>
                  <button
                    (click)="openDeleteModal(product)"
                    class="font-medium text-red-600 hover:underline">
                    Удалить
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Categories Tab -->
    <div *ngIf="activeTab === 'categories'">
      <div class="flex justify-end mb-6">
        <button
          (click)="openNewCategoryModal()"
          class="bg-indigo-600 text-white font-bold py-2 px-4 rounded-md hover:bg-indigo-700 flex items-center">
          <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z" clip-rule="evenodd" />
          </svg>
          Добавить категорию
        </button>
      </div>
      <div class="bg-white rounded-lg shadow-sm overflow-hidden">
        <div class="overflow-x-auto">
          <table class="w-full text-sm text-left text-gray-500">
            <thead class="text-xs text-gray-700 uppercase bg-gray-50">
              <tr>
                <th scope="col" class="px-6 py-3">Название категории</th>
                <th scope="col" class="px-6 py-3">Кол-во товаров</th>
                <th scope="col" class="px-6 py-3 text-right">Действия</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let category of categories" class="bg-white border-b hover:bg-gray-50">
                <td class="px-6 py-4 font-medium text-gray-900">{{ category.name }}</td>
                <td class="px-6 py-4">{{ category.productCount }}</td>
                <td class="px-6 py-4 text-right space-x-2">
                  <button
                    (click)="editCategory(category)"
                    class="font-medium text-indigo-600 hover:underline">
                    Редактировать
                  </button>
                  <button
                    (click)="openDeleteModal(category)"
                    class="font-medium text-red-600 hover:underline">
                    Удалить
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </main>

  <!-- Hide Modal -->
  <div *ngIf="showHideModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50" (click)="closeHideModal()">
    <div class="bg-white rounded-lg shadow-xl w-full max-w-md m-4" (click)="$event.stopPropagation()">
      <div class="p-6">
        <div class="flex justify-between items-center">
          <h3 class="text-lg font-bold text-gray-800">Скрыть товар</h3>
          <button (click)="closeHideModal()" class="text-gray-400 hover:text-gray-600">
            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
            </svg>
          </button>
        </div>
        <p class="text-sm text-gray-600 mt-2">Вы уверены, что хотите скрыть этот товар? Он не будет отображаться в каталоге.</p>
      </div>
      <div class="bg-gray-50 px-6 py-4 flex justify-end space-x-3">
        <button (click)="closeHideModal()" class="px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300">Отмена</button>
        <button (click)="confirmHide()" class="px-4 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 font-semibold">Скрыть</button>
      </div>
    </div>
  </div>

  <!-- Delete Modal -->
  <div *ngIf="showDeleteModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50" (click)="closeDeleteModal()">
    <div class="bg-white rounded-lg shadow-xl w-full max-w-md m-4" (click)="$event.stopPropagation()">
      <div class="p-6">
        <div class="flex justify-between items-center">
          <h3 class="text-lg font-bold text-gray-800">Удалить</h3>
          <button (click)="closeDeleteModal()" class="text-gray-400 hover:text-gray-600">
            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
            </svg>
          </button>
        </div>
        <p class="text-sm text-gray-600 mt-2">Вы уверены, что хотите удалить этот элемент? Это действие нельзя отменить.</p>
      </div>
      <div class="bg-gray-50 px-6 py-4 flex justify-end space-x-3">
        <button (click)="closeDeleteModal()" class="px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300">Отмена</button>
        <button (click)="confirmDelete()" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 font-semibold">Удалить</button>
      </div>
    </div>
  </div>

  <!-- New Category Modal -->
  <div *ngIf="showNewCategoryModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50" (click)="closeNewCategoryModal()">
    <div class="bg-white rounded-lg shadow-xl w-full max-w-md m-4" (click)="$event.stopPropagation()">
      <div class="p-6">
        <div class="flex justify-between items-center">
          <h3 class="text-lg font-bold text-gray-800">Добавить категорию</h3>
          <button (click)="closeNewCategoryModal()" class="text-gray-400 hover:text-gray-600">
            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
            </svg>
          </button>
        </div>
        <div class="mt-4">
          <label for="categoryName" class="block text-sm font-medium text-gray-700">Название категории</label>
          <input
            id="categoryName"
            type="text"
            [(ngModel)]="newCategoryName"
            class="mt-1 w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
            placeholder="Например: Молочные продукты">
        </div>
      </div>
      <div class="bg-gray-50 px-6 py-4 flex justify-end space-x-3">
        <button (click)="closeNewCategoryModal()" class="px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300">Отмена</button>
        <button (click)="addCategory()" class="px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-semibold">Добавить</button>
      </div>
    </div>
  </div>
</div>
