{
  "info": {
    "name": "Order Exchange - Full Collection",
    "description": "Complete API collection for Order Exchange microservices platform.\n\nПорядок использования:\n1. Запустите Login или зарегистрируйте пользователя\n2. Токен автоматически сохранится в переменную коллекции\n3. Все последующие запросы будут использовать этот токен",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{token}}",
        "type": "string"
      }
    ]
  },
  "variable": [
    {"key": "baseUrl", "value": "http://localhost:8765"},
    {"key": "token", "value": ""},
    {"key": "userId", "value": "1"},
    {"key": "companyId", "value": "1"},
    {"key": "orderId", "value": "1"},
    {"key": "productId", "value": "1"},
    {"key": "categoryId", "value": "1"},
    {"key": "channelId", "value": "1"},
    {"key": "ticketId", "value": "1"}
  ],
  "item": [
    {
      "name": "Auth Service",
      "description": "Аутентификация и управление пользователями",
      "item": [
        {
          "name": "Login (Supplier)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    var json = pm.response.json();",
                  "    pm.collectionVariables.set('token', json.token);",
                  "    pm.collectionVariables.set('userId', json.userId);",
                  "    pm.collectionVariables.set('companyId', json.companyId);",
                  "    pm.test('Login successful', function() {",
                  "        pm.expect(json.token).to.not.be.empty;",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {"type": "noauth"},
            "method": "POST",
            "header": [
              {"key": "Content-Type", "value": "application/json"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"email\": \"supplier@test.com\",\n    \"password\": \"password123\"\n}"
            },
            "url": "{{baseUrl}}/api/auth/login"
          }
        },
        {
          "name": "Login (Retail Chain)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    var json = pm.response.json();",
                  "    pm.collectionVariables.set('token', json.token);",
                  "    pm.collectionVariables.set('userId', json.userId);",
                  "    pm.collectionVariables.set('companyId', json.companyId);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {"type": "noauth"},
            "method": "POST",
            "header": [
              {"key": "Content-Type", "value": "application/json"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"email\": \"retailchain@test.com\",\n    \"password\": \"password123\"\n}"
            },
            "url": "{{baseUrl}}/api/auth/login"
          }
        },
        {
          "name": "Login (Admin)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    var json = pm.response.json();",
                  "    pm.collectionVariables.set('token', json.token);",
                  "    pm.collectionVariables.set('userId', json.userId);",
                  "    pm.collectionVariables.set('companyId', json.companyId);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {"type": "noauth"},
            "method": "POST",
            "header": [
              {"key": "Content-Type", "value": "application/json"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"email\": \"admin@system.com\",\n    \"password\": \"admin123\"\n}"
            },
            "url": "{{baseUrl}}/api/auth/login"
          }
        },
        {
          "name": "Register Supplier (form-data)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    var json = pm.response.json();",
                  "    pm.collectionVariables.set('token', json.token);",
                  "    pm.collectionVariables.set('userId', json.userId);",
                  "    pm.collectionVariables.set('companyId', json.companyId);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {"type": "noauth"},
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {"key": "type", "value": "SUPPLIER", "type": "text"},
                {"key": "email", "value": "newsupplier@test.com", "type": "text"},
                {"key": "password", "value": "password123", "type": "text"},
                {"key": "passwordConfirm", "value": "password123", "type": "text"},
                {"key": "legalName", "value": "ООО Новый Поставщик", "type": "text"},
                {"key": "legalForm", "value": "LLC", "type": "text"},
                {"key": "taxId", "value": "1234567890123", "type": "text"},
                {"key": "registrationDate", "value": "2020-01-15", "type": "text"},
                {"key": "contactPhone", "value": "+375291234567", "type": "text"},
                {"key": "legalAddress", "value": "г. Минск, ул. Тестовая, д. 1", "type": "text"},
                {"key": "postalAddress", "value": "г. Минск, ул. Тестовая, д. 1", "type": "text"},
                {"key": "shippingAddress", "value": "г. Минск, ул. Складская, д. 5", "type": "text"},
                {"key": "directorName", "value": "Иванов Иван Иванович", "type": "text"},
                {"key": "accountantName", "value": "Петрова Анна Сергеевна", "type": "text"},
                {"key": "bankName", "value": "ОАО Беларусбанк", "type": "text"},
                {"key": "bankBic", "value": "AKBBBY2X", "type": "text"},
                {"key": "bankAccount", "value": "BY20AKBB30120000000123456789", "type": "text"},
                {"key": "paymentTerms", "value": "PREPAYMENT", "type": "text"}
              ]
            },
            "url": "{{baseUrl}}/api/auth/register"
          }
        },
        {
          "name": "Register Retail Chain (form-data)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    var json = pm.response.json();",
                  "    pm.collectionVariables.set('token', json.token);",
                  "    pm.collectionVariables.set('userId', json.userId);",
                  "    pm.collectionVariables.set('companyId', json.companyId);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {"type": "noauth"},
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {"key": "type", "value": "RETAIL_CHAIN", "type": "text"},
                {"key": "email", "value": "newretailchain@test.com", "type": "text"},
                {"key": "password", "value": "password123", "type": "text"},
                {"key": "passwordConfirm", "value": "password123", "type": "text"},
                {"key": "legalName", "value": "ООО Новая Торговая Сеть", "type": "text"},
                {"key": "legalForm", "value": "LLC", "type": "text"},
                {"key": "taxId", "value": "9876543210123", "type": "text"},
                {"key": "registrationDate", "value": "2019-05-20", "type": "text"},
                {"key": "contactPhone", "value": "+375297654321", "type": "text"},
                {"key": "legalAddress", "value": "г. Минск, пр. Независимости, д. 100", "type": "text"},
                {"key": "postalAddress", "value": "г. Минск, пр. Независимости, д. 100", "type": "text"},
                {"key": "deliveryAddresses", "value": "[\"г. Минск, ул. Магазинная 1\", \"г. Минск, ул. Магазинная 2\"]", "type": "text"},
                {"key": "directorName", "value": "Сидоров Петр Петрович", "type": "text"},
                {"key": "bankName", "value": "ОАО Приорбанк", "type": "text"},
                {"key": "bankBic", "value": "PJCBBY2X", "type": "text"},
                {"key": "bankAccount", "value": "BY20PJCB30120000000987654321", "type": "text"}
              ]
            },
            "url": "{{baseUrl}}/api/auth/register"
          }
        },
        {
          "name": "Get User Profile",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/api/auth/profile"
          }
        },
        {
          "name": "Get Company Profile",
          "request": {
            "auth": {"type": "noauth"},
            "method": "GET",
            "url": "{{baseUrl}}/api/auth/company/{{companyId}}"
          }
        },
        {
          "name": "Validate Token",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/api/auth/validate"
          }
        }
      ]
    },
    {
      "name": "Admin",
      "description": "Административные функции (только для ADMIN)",
      "item": [
        {
          "name": "Get All Users",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/api/admin/users"
          }
        },
        {
          "name": "Get User by ID",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/api/admin/users/{{userId}}"
          }
        },
        {
          "name": "Block User",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/api/admin/users/{{userId}}/block"
          }
        },
        {
          "name": "Unblock User",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/api/admin/users/{{userId}}/unblock"
          }
        },
        {
          "name": "Get Dashboard Stats",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/api/admin/dashboard/stats"
          }
        },
        {
          "name": "Get Users Stats",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/api/admin/dashboard/users-stats"
          }
        }
      ]
    },
    {
      "name": "Verification",
      "description": "Верификация компаний",
      "item": [
        {
          "name": "Get Pending Requests",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/api/verification/requests/pending"
          }
        },
        {
          "name": "Get All Requests",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/api/verification/requests"
          }
        },
        {
          "name": "Approve Request",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/api/verification/requests/1/approve"
          }
        },
        {
          "name": "Reject Request",
          "request": {
            "method": "POST",
            "header": [
              {"key": "Content-Type", "value": "application/json"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"reason\": \"Документы не соответствуют требованиям\"\n}"
            },
            "url": "{{baseUrl}}/api/verification/requests/1/reject"
          }
        },
        {
          "name": "Request Additional Info",
          "request": {
            "method": "POST",
            "header": [
              {"key": "Content-Type", "value": "application/json"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"message\": \"Пожалуйста, загрузите копию свидетельства о регистрации\"\n}"
            },
            "url": "{{baseUrl}}/api/verification/requests/1/request-info"
          }
        }
      ]
    },
    {
      "name": "Catalog - Categories",
      "description": "Управление категориями товаров",
      "item": [
        {
          "name": "Get All Categories",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/api/categories"
          }
        },
        {
          "name": "Get Category by ID",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/api/categories/{{categoryId}}"
          }
        },
        {
          "name": "Create Category",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    var json = pm.response.json();",
                  "    if (json.data && json.data.id) {",
                  "        pm.collectionVariables.set('categoryId', json.data.id);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {"key": "Content-Type", "value": "application/json"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Молочные продукты\",\n    \"description\": \"Молоко, сыры, йогурты и другие молочные продукты\",\n    \"parentId\": null\n}"
            },
            "url": "{{baseUrl}}/api/categories"
          }
        },
        {
          "name": "Update Category",
          "request": {
            "method": "PUT",
            "header": [
              {"key": "Content-Type", "value": "application/json"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Молочная продукция\",\n    \"description\": \"Обновленное описание категории\"\n}"
            },
            "url": "{{baseUrl}}/api/categories/{{categoryId}}"
          }
        },
        {
          "name": "Delete Category",
          "request": {
            "method": "DELETE",
            "url": "{{baseUrl}}/api/categories/{{categoryId}}"
          }
        }
      ]
    },
    {
      "name": "Catalog - Products",
      "description": "Управление товарами поставщика",
      "item": [
        {
          "name": "Get All Products",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/api/products"
          }
        },
        {
          "name": "Get Products by Company",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/api/products/company/{{companyId}}"
          }
        },
        {
          "name": "Get Product by ID",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/api/products/{{productId}}"
          }
        },
        {
          "name": "Search Products",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/products/search?query=молоко",
              "host": ["{{baseUrl}}"],
              "path": ["api", "products", "search"],
              "query": [
                {"key": "query", "value": "молоко"}
              ]
            }
          }
        },
        {
          "name": "Create Product",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    var json = pm.response.json();",
                  "    if (json.data && json.data.id) {",
                  "        pm.collectionVariables.set('productId', json.data.id);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {"key": "Content-Type", "value": "application/json"},
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"sku\": \"MILK-001\",\n    \"name\": \"Молоко 3.2%\",\n    \"description\": \"Молоко коровье пастеризованное 3.2% жирности\",\n    \"categoryId\": 1,\n    \"pricePerUnit\": 2.50,\n    \"unitId\": 1,\n    \"vatRateId\": 1,\n    \"minOrderQuantity\": 10,\n    \"isActive\": true\n}"
            },
            "url": "{{baseUrl}}/api/products"
          }
        },
        {
          "name": "Update Product",
          "request": {
            "method": "PUT",
            "header": [
              {"key": "Content-Type", "value": "application/json"},
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Молоко 3.2% (обновлено)\",\n    \"pricePerUnit\": 2.75,\n    \"minOrderQuantity\": 5\n}"
            },
            "url": "{{baseUrl}}/api/products/{{productId}}"
          }
        },
        {
          "name": "Delete Product",
          "request": {
            "method": "DELETE",
            "header": [
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "url": "{{baseUrl}}/api/products/{{productId}}"
          }
        }
      ]
    },
    {
      "name": "Catalog - Inventory",
      "description": "Управление остатками товаров",
      "item": [
        {
          "name": "Get Product Inventory",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/api/inventory/product/{{productId}}"
          }
        },
        {
          "name": "Get Supplier Inventory",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/api/inventory/supplier/{{companyId}}"
          }
        },
        {
          "name": "Update Inventory",
          "request": {
            "method": "PUT",
            "header": [
              {"key": "Content-Type", "value": "application/json"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"productId\": {{productId}},\n    \"quantity\": 100,\n    \"reservedQuantity\": 0\n}"
            },
            "url": "{{baseUrl}}/api/inventory/product/{{productId}}"
          }
        },
        {
          "name": "Reserve Stock",
          "request": {
            "method": "POST",
            "header": [
              {"key": "Content-Type", "value": "application/json"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"productId\": {{productId}},\n    \"quantity\": 10\n}"
            },
            "url": "{{baseUrl}}/api/inventory/reserve"
          }
        },
        {
          "name": "Release Stock",
          "request": {
            "method": "POST",
            "header": [
              {"key": "Content-Type", "value": "application/json"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"productId\": {{productId}},\n    \"quantity\": 5\n}"
            },
            "url": "{{baseUrl}}/api/inventory/release"
          }
        }
      ]
    },
    {
      "name": "Cart",
      "description": "Корзина покупок (для торговой сети)",
      "item": [
        {
          "name": "Get Cart",
          "request": {
            "method": "GET",
            "header": [
              {"key": "X-User-Id", "value": "{{userId}}"},
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "url": "{{baseUrl}}/api/cart"
          }
        },
        {
          "name": "Add to Cart",
          "request": {
            "method": "POST",
            "header": [
              {"key": "Content-Type", "value": "application/json"},
              {"key": "X-User-Id", "value": "{{userId}}"},
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"productId\": {{productId}},\n    \"quantity\": 10\n}"
            },
            "url": "{{baseUrl}}/api/cart/add"
          }
        },
        {
          "name": "Update Cart Item",
          "request": {
            "method": "PUT",
            "header": [
              {"key": "Content-Type", "value": "application/json"},
              {"key": "X-User-Id", "value": "{{userId}}"},
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"quantity\": 20\n}"
            },
            "url": "{{baseUrl}}/api/cart/items/{{productId}}"
          }
        },
        {
          "name": "Remove from Cart",
          "request": {
            "method": "DELETE",
            "header": [
              {"key": "X-User-Id", "value": "{{userId}}"},
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "url": "{{baseUrl}}/api/cart/items/{{productId}}"
          }
        },
        {
          "name": "Clear Cart",
          "request": {
            "method": "DELETE",
            "header": [
              {"key": "X-User-Id", "value": "{{userId}}"},
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "url": "{{baseUrl}}/api/cart"
          }
        }
      ]
    },
    {
      "name": "Orders",
      "description": "Управление заказами",
      "item": [
        {
          "name": "Create Order from Cart",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    var json = pm.response.json();",
                  "    if (json.data && json.data.id) {",
                  "        pm.collectionVariables.set('orderId', json.data.id);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {"key": "Content-Type", "value": "application/json"},
              {"key": "X-User-Id", "value": "{{userId}}"},
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"deliveryAddressId\": 1,\n    \"comment\": \"Доставка в рабочее время\"\n}"
            },
            "url": "{{baseUrl}}/api/orders/from-cart"
          }
        },
        {
          "name": "Get My Orders (Customer)",
          "request": {
            "method": "GET",
            "header": [
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "url": "{{baseUrl}}/api/orders/customer"
          }
        },
        {
          "name": "Get My Orders (Supplier)",
          "request": {
            "method": "GET",
            "header": [
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "url": "{{baseUrl}}/api/orders/supplier"
          }
        },
        {
          "name": "Get Order by ID",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/api/orders/{{orderId}}"
          }
        },
        {
          "name": "Confirm Order (Supplier)",
          "request": {
            "method": "POST",
            "header": [
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "url": "{{baseUrl}}/api/orders/{{orderId}}/confirm"
          }
        },
        {
          "name": "Reject Order (Supplier)",
          "request": {
            "method": "POST",
            "header": [
              {"key": "Content-Type", "value": "application/json"},
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"reason\": \"Нет товара в наличии\"\n}"
            },
            "url": "{{baseUrl}}/api/orders/{{orderId}}/reject"
          }
        },
        {
          "name": "Upload Payment (Customer)",
          "request": {
            "method": "POST",
            "header": [
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "body": {
              "mode": "formdata",
              "formdata": [
                {"key": "file", "type": "file", "src": ""},
                {"key": "paymentAmount", "value": "1000.00", "type": "text"}
              ]
            },
            "url": "{{baseUrl}}/api/orders/{{orderId}}/payment"
          }
        },
        {
          "name": "Verify Payment (Supplier)",
          "request": {
            "method": "POST",
            "header": [
              {"key": "Content-Type", "value": "application/json"},
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"verified\": true\n}"
            },
            "url": "{{baseUrl}}/api/orders/{{orderId}}/verify-payment"
          }
        },
        {
          "name": "Start Shipment",
          "request": {
            "method": "POST",
            "header": [
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "url": "{{baseUrl}}/api/orders/{{orderId}}/ship"
          }
        },
        {
          "name": "Confirm Delivery",
          "request": {
            "method": "POST",
            "header": [
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "url": "{{baseUrl}}/api/orders/{{orderId}}/deliver"
          }
        },
        {
          "name": "Close Order",
          "request": {
            "method": "POST",
            "header": [
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "url": "{{baseUrl}}/api/orders/{{orderId}}/close"
          }
        }
      ]
    },
    {
      "name": "Analytics",
      "description": "Аналитика и KPI",
      "item": [
        {
          "name": "Get Supplier KPI",
          "request": {
            "method": "GET",
            "header": [
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "url": {
              "raw": "{{baseUrl}}/api/analytics/supplier/kpi?period=MONTH",
              "host": ["{{baseUrl}}"],
              "path": ["api", "analytics", "supplier", "kpi"],
              "query": [
                {"key": "period", "value": "MONTH"}
              ]
            }
          }
        },
        {
          "name": "Get Supplier Order Funnel",
          "request": {
            "method": "GET",
            "header": [
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "url": "{{baseUrl}}/api/analytics/supplier/funnel"
          }
        },
        {
          "name": "Get Supplier Sales Dynamics",
          "request": {
            "method": "GET",
            "header": [
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "url": {
              "raw": "{{baseUrl}}/api/analytics/supplier/sales-dynamics?period=MONTH",
              "host": ["{{baseUrl}}"],
              "path": ["api", "analytics", "supplier", "sales-dynamics"],
              "query": [
                {"key": "period", "value": "MONTH"}
              ]
            }
          }
        },
        {
          "name": "Get Supplier Top Products",
          "request": {
            "method": "GET",
            "header": [
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "url": "{{baseUrl}}/api/analytics/supplier/top-products"
          }
        },
        {
          "name": "Get Supplier Client Analytics",
          "request": {
            "method": "GET",
            "header": [
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "url": "{{baseUrl}}/api/analytics/supplier/clients"
          }
        },
        {
          "name": "Get Customer KPI",
          "request": {
            "method": "GET",
            "header": [
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "url": {
              "raw": "{{baseUrl}}/api/analytics/customer/kpi?period=MONTH",
              "host": ["{{baseUrl}}"],
              "path": ["api", "analytics", "customer", "kpi"],
              "query": [
                {"key": "period", "value": "MONTH"}
              ]
            }
          }
        },
        {
          "name": "Get Customer Spending Dynamics",
          "request": {
            "method": "GET",
            "header": [
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "url": {
              "raw": "{{baseUrl}}/api/analytics/customer/spending-dynamics?period=MONTH",
              "host": ["{{baseUrl}}"],
              "path": ["api", "analytics", "customer", "spending-dynamics"],
              "query": [
                {"key": "period", "value": "MONTH"}
              ]
            }
          }
        },
        {
          "name": "Get Customer Expense Structure",
          "request": {
            "method": "GET",
            "header": [
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "url": "{{baseUrl}}/api/analytics/customer/expense-structure"
          }
        },
        {
          "name": "Get Customer Supplier Analytics",
          "request": {
            "method": "GET",
            "header": [
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "url": "{{baseUrl}}/api/analytics/customer/suppliers"
          }
        },
        {
          "name": "Get Product Purchase History",
          "request": {
            "method": "GET",
            "header": [
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "url": "{{baseUrl}}/api/analytics/customer/product-history/{{productId}}"
          }
        }
      ]
    },
    {
      "name": "Chat - Order Channels",
      "description": "Чат между поставщиком и покупателем по заказу",
      "item": [
        {
          "name": "Create Order Chat Channel",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    var json = pm.response.json();",
                  "    if (json.data && json.data.id) {",
                  "        pm.collectionVariables.set('channelId', json.data.id);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {"key": "Content-Type", "value": "application/json"},
              {"key": "X-User-Id", "value": "{{userId}}"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"orderId\": {{orderId}},\n    \"supplierUserId\": 2,\n    \"customerUserId\": {{userId}}\n}"
            },
            "url": "{{baseUrl}}/api/chats"
          }
        },
        {
          "name": "Get Channel by Order ID",
          "request": {
            "method": "GET",
            "header": [
              {"key": "X-User-Id", "value": "{{userId}}"}
            ],
            "url": "{{baseUrl}}/api/chats/order/{{orderId}}"
          }
        },
        {
          "name": "Get My Channels",
          "request": {
            "method": "GET",
            "header": [
              {"key": "X-User-Id", "value": "{{userId}}"}
            ],
            "url": "{{baseUrl}}/api/chats"
          }
        },
        {
          "name": "Send Message to Channel",
          "request": {
            "method": "POST",
            "header": [
              {"key": "Content-Type", "value": "application/json"},
              {"key": "X-User-Id", "value": "{{userId}}"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"content\": \"Здравствуйте! Когда будет доставка?\"\n}"
            },
            "url": "{{baseUrl}}/api/chats/order/{{orderId}}/messages"
          }
        },
        {
          "name": "Get Channel Messages",
          "request": {
            "method": "GET",
            "header": [
              {"key": "X-User-Id", "value": "{{userId}}"}
            ],
            "url": "{{baseUrl}}/api/chats/order/{{orderId}}/messages"
          }
        },
        {
          "name": "Mark Messages as Read",
          "request": {
            "method": "POST",
            "header": [
              {"key": "X-User-Id", "value": "{{userId}}"}
            ],
            "url": "{{baseUrl}}/api/chats/order/{{orderId}}/read"
          }
        },
        {
          "name": "Deactivate Channel",
          "request": {
            "method": "POST",
            "header": [
              {"key": "X-User-Id", "value": "{{userId}}"}
            ],
            "url": "{{baseUrl}}/api/chats/order/{{orderId}}/deactivate"
          }
        }
      ]
    },
    {
      "name": "Support Tickets",
      "description": "Тикеты поддержки (юзер - админ)",
      "item": [
        {
          "name": "Create Support Ticket",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    var json = pm.response.json();",
                  "    if (json.data && json.data.id) {",
                  "        pm.collectionVariables.set('ticketId', json.data.id);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {"key": "Content-Type", "value": "application/json"},
              {"key": "X-User-Id", "value": "{{userId}}"},
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"subject\": \"Проблема с верификацией\",\n    \"description\": \"Не могу загрузить документы для верификации компании\",\n    \"category\": \"VERIFICATION_ISSUE\"\n}"
            },
            "url": "{{baseUrl}}/api/support/tickets"
          }
        },
        {
          "name": "Get My Tickets",
          "request": {
            "method": "GET",
            "header": [
              {"key": "X-User-Id", "value": "{{userId}}"},
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "url": "{{baseUrl}}/api/support/tickets"
          }
        },
        {
          "name": "Get All Tickets (Admin)",
          "request": {
            "method": "GET",
            "header": [
              {"key": "X-User-Role", "value": "ADMIN"}
            ],
            "url": "{{baseUrl}}/api/support/tickets/admin"
          }
        },
        {
          "name": "Get Tickets by Status (Admin)",
          "request": {
            "method": "GET",
            "header": [
              {"key": "X-User-Role", "value": "ADMIN"}
            ],
            "url": {
              "raw": "{{baseUrl}}/api/support/tickets/admin?status=OPEN",
              "host": ["{{baseUrl}}"],
              "path": ["api", "support", "tickets", "admin"],
              "query": [
                {"key": "status", "value": "OPEN"}
              ]
            }
          }
        },
        {
          "name": "Get Ticket by ID",
          "request": {
            "method": "GET",
            "header": [
              {"key": "X-User-Id", "value": "{{userId}}"},
              {"key": "X-User-Role", "value": "USER"}
            ],
            "url": "{{baseUrl}}/api/support/tickets/{{ticketId}}"
          }
        },
        {
          "name": "Assign Ticket (Admin)",
          "request": {
            "method": "POST",
            "header": [
              {"key": "X-User-Id", "value": "{{userId}}"}
            ],
            "url": "{{baseUrl}}/api/support/tickets/{{ticketId}}/assign"
          }
        },
        {
          "name": "Send Message to Ticket",
          "request": {
            "method": "POST",
            "header": [
              {"key": "Content-Type", "value": "application/json"},
              {"key": "X-User-Id", "value": "{{userId}}"},
              {"key": "X-User-Role", "value": "USER"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"content\": \"Спасибо за обращение. Мы рассмотрим вашу проблему.\"\n}"
            },
            "url": "{{baseUrl}}/api/support/tickets/{{ticketId}}/messages"
          }
        },
        {
          "name": "Get Ticket Messages",
          "request": {
            "method": "GET",
            "header": [
              {"key": "X-User-Id", "value": "{{userId}}"},
              {"key": "X-User-Role", "value": "USER"}
            ],
            "url": "{{baseUrl}}/api/support/tickets/{{ticketId}}/messages"
          }
        },
        {
          "name": "Resolve Ticket (Admin)",
          "request": {
            "method": "POST",
            "header": [
              {"key": "X-User-Id", "value": "{{userId}}"}
            ],
            "url": "{{baseUrl}}/api/support/tickets/{{ticketId}}/resolve"
          }
        },
        {
          "name": "Close Ticket",
          "request": {
            "method": "POST",
            "header": [
              {"key": "X-User-Id", "value": "{{userId}}"}
            ],
            "url": "{{baseUrl}}/api/support/tickets/{{ticketId}}/close"
          }
        },
        {
          "name": "Reopen Ticket",
          "request": {
            "method": "POST",
            "header": [
              {"key": "X-User-Id", "value": "{{userId}}"}
            ],
            "url": "{{baseUrl}}/api/support/tickets/{{ticketId}}/reopen"
          }
        }
      ]
    },
    {
      "name": "Documents",
      "description": "Загрузка и управление документами",
      "item": [
        {
          "name": "Upload Document",
          "request": {
            "method": "POST",
            "header": [
              {"key": "X-User-Id", "value": "{{userId}}"},
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "body": {
              "mode": "formdata",
              "formdata": [
                {"key": "file", "type": "file", "src": ""},
                {"key": "documentTypeCode", "value": "INVOICE", "type": "text"},
                {"key": "entityType", "value": "ORDER", "type": "text"},
                {"key": "entityId", "value": "{{orderId}}", "type": "text"}
              ]
            },
            "url": "{{baseUrl}}/api/documents"
          }
        },
        {
          "name": "Get Documents by Order",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/api/documents/entity/ORDER/{{orderId}}"
          }
        },
        {
          "name": "Download Document",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/api/documents/1/download"
          }
        },
        {
          "name": "Get Document Types",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/api/documents/types"
          }
        }
      ]
    },
    {
      "name": "Generated Documents",
      "description": "Генерация PDF документов",
      "item": [
        {
          "name": "Generate Invoice",
          "request": {
            "method": "POST",
            "header": [
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "url": "{{baseUrl}}/api/generated-documents/invoice/{{orderId}}"
          }
        },
        {
          "name": "Generate Delivery Note (TTN)",
          "request": {
            "method": "POST",
            "header": [
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "url": "{{baseUrl}}/api/generated-documents/delivery-note/{{orderId}}"
          }
        },
        {
          "name": "Generate Acceptance Act",
          "request": {
            "method": "POST",
            "header": [
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "url": "{{baseUrl}}/api/generated-documents/acceptance-act/{{orderId}}"
          }
        },
        {
          "name": "Generate Discrepancy Act",
          "request": {
            "method": "POST",
            "header": [
              {"key": "Content-Type", "value": "application/json"},
              {"key": "X-User-Company-Id", "value": "{{companyId}}"}
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"orderId\": {{orderId}},\n    \"discrepancies\": [\n        {\n            \"productId\": 1,\n            \"expectedQuantity\": 100,\n            \"actualQuantity\": 95,\n            \"reason\": \"Повреждение при транспортировке\"\n        }\n    ]\n}"
            },
            "url": "{{baseUrl}}/api/generated-documents/discrepancy-act"
          }
        },
        {
          "name": "Get Generated Documents by Order",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/api/generated-documents/order/{{orderId}}"
          }
        },
        {
          "name": "Download Generated Document",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/api/generated-documents/1/download"
          }
        }
      ]
    },
    {
      "name": "Reference Data",
      "description": "Справочные данные",
      "item": [
        {
          "name": "Get Units of Measure",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/api/units"
          }
        },
        {
          "name": "Get VAT Rates",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/api/vat-rates"
          }
        },
        {
          "name": "Get Company Addresses",
          "request": {
            "auth": {"type": "noauth"},
            "method": "GET",
            "url": "{{baseUrl}}/api/addresses/company/{{companyId}}"
          }
        }
      ]
    }
  ]
}

