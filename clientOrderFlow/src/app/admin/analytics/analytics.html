<div class="flex-1 flex flex-col">
  <admin-header [title]="'Аналитика платформы'"></admin-header>

  <main class="flex-1 overflow-x-hidden overflow-y-auto p-6">
    <!-- Period Filter -->
    <div class="mb-6 flex flex-wrap items-center justify-between">
      <div class="flex items-center space-x-2 bg-white p-1 rounded-lg shadow-sm">
        <button (click)="setPeriod('today')" [class.bg-indigo-600]="selectedPeriod === 'today'" [class.text-white]="selectedPeriod === 'today'" [class.text-gray-600]="selectedPeriod !== 'today'" class="px-3 py-1 rounded-md text-sm font-medium">Сегодня</button>
        <button (click)="setPeriod('week')" [class.bg-indigo-600]="selectedPeriod === 'week'" [class.text-white]="selectedPeriod === 'week'" [class.text-gray-600]="selectedPeriod !== 'week'" class="px-3 py-1 rounded-md text-sm font-medium">Неделя</button>
        <button (click)="setPeriod('month')" [class.bg-indigo-600]="selectedPeriod === 'month'" [class.text-white]="selectedPeriod === 'month'" [class.text-gray-600]="selectedPeriod !== 'month'" class="px-3 py-1 rounded-md text-sm font-medium">Месяц</button>
        <button (click)="setPeriod('quarter')" [class.bg-indigo-600]="selectedPeriod === 'quarter'" [class.text-white]="selectedPeriod === 'quarter'" [class.text-gray-600]="selectedPeriod !== 'quarter'" class="px-3 py-1 rounded-md text-sm font-medium">Квартал</button>
      </div>
      <div class="flex items-center space-x-2 mt-2 sm:mt-0">
        <input type="date" class="bg-white px-3 py-1.5 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-indigo-500 text-gray-500">
        <span class="text-gray-500">-</span>
        <input type="date" class="bg-white px-3 py-1.5 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-indigo-500 text-gray-500">
      </div>
    </div>

    <!-- KPI Cards -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
      <div class="bg-white p-5 rounded-lg shadow-sm">
        <p class="text-sm text-gray-500">Всего пользователей</p>
        <p class="text-3xl font-bold text-gray-800 mt-1">{{ kpiData.totalUsers }}</p>
      </div>
      <div class="bg-white p-5 rounded-lg shadow-sm">
        <p class="text-sm text-gray-500">Количество заказов</p>
        <p class="text-3xl font-bold text-gray-800 mt-1">{{ kpiData.totalOrders }}</p>
      </div>
      <div class="bg-white p-5 rounded-lg shadow-sm">
        <p class="text-sm text-gray-500">Общий оборот</p>
        <p class="text-3xl font-bold text-gray-800 mt-1">{{ kpiData.totalRevenue }} BYN</p>
      </div>
      <div class="bg-white p-5 rounded-lg shadow-sm">
        <p class="text-sm text-gray-500">Средний чек</p>
        <p class="text-3xl font-bold text-gray-800 mt-1">{{ kpiData.averageCheck }} BYN</p>
      </div>
    </div>

    <!-- Main Chart -->
    <div class="mt-8 bg-white p-6 rounded-lg shadow-sm">
      <h3 class="text-lg font-semibold text-gray-800 mb-4">Динамика заказов и оборота</h3>
      <div class="h-80">
        <canvas #mainChart></canvas>
      </div>
    </div>

    <!-- Additional Charts -->
    <div class="mt-8 grid grid-cols-1 lg:grid-cols-3 gap-8">
      <div class="lg:col-span-1 bg-white p-6 rounded-lg shadow-sm">
        <h3 class="text-lg font-semibold text-gray-800 mb-4">Распределение ролей</h3>
        <div class="h-64 flex items-center justify-center">
          <canvas #rolesChart></canvas>
        </div>
      </div>
      <div class="lg:col-span-2 bg-white p-6 rounded-lg shadow-sm">
        <h3 class="text-lg font-semibold text-gray-800 mb-4">Новые регистрации</h3>
        <div class="h-64">
          <canvas #usersChart></canvas>
        </div>
      </div>
    </div>

    <!-- Top Lists -->
    <div class="mt-8 grid grid-cols-1 lg:grid-cols-2 gap-8">
      <div class="bg-white p-6 rounded-lg shadow-sm">
        <h3 class="text-lg font-semibold text-gray-800 mb-4">Топ-5 Поставщиков по обороту</h3>
        <ul class="space-y-3">
          <li *ngFor="let supplier of topSuppliers" class="flex justify-between items-center text-sm">
            <span class="font-medium text-gray-800">{{ supplier.name }}</span>
            <span class="font-semibold text-indigo-600">{{ supplier.revenue }} BYN</span>
          </li>
        </ul>
      </div>
      <div class="bg-white p-6 rounded-lg shadow-sm">
        <h3 class="text-lg font-semibold text-gray-800 mb-4">Топ-5 Торговых сетей по обороту</h3>
        <ul class="space-y-3">
          <li *ngFor="let retailer of topRetailers" class="flex justify-between items-center text-sm">
            <span class="font-medium text-gray-800">{{ retailer.name }}</span>
            <span class="font-semibold text-indigo-600">{{ retailer.revenue }} BYN</span>
          </li>
        </ul>
      </div>
    </div>
  </main>
</div>
